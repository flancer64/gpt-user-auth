# Сценарий регистрации пользователя веб-приложения через ChatGPT

## Общее описание сценария

### 1. Инициация регистрации

- Пользователь выражает желание зарегистрироваться в веб-приложении. ChatGPT собирает следующие данные в разговорной
  форме:
    - **Адрес электронной почты пользователя**.
    - **Согласие на обработку персональных данных**.
    - **Предпочитаемую локаль** для взаимодействия с приложением.
    - **Парольную фразу**, которая будет использоваться для подтверждения прав на идентификатор (PIN-код) в будущем.

### 2. Передача данных

- Чат передаёт собранные данные на сервер веб-приложения через точку входа инициации регистрации (
  `Fl64_Gpt_User_Back_Web_Api_SignUp_Init`):
    - Email.
    - Согласие пользователя.
    - Парольную фразу.
    - Локаль пользователя.

### 3. Регистрация пользователя в веб-приложении

- Веб-приложение проверяет email-адрес:
    - Если email уже зарегистрирован, процесс отклоняется, и чат уведомляет пользователя, предлагая страницу
      восстановления пароля.
    - Если email новый, создаётся запись пользователя со статусом **"ожидает верификации"**.
- На этом этапе:
    - Генерируется **публичный PIN-код** — идентификатор пользователя.
    - PIN-код сохраняется в базе данных, но статус пользователя остаётся **неактивным**.
- Пользователю отправляется письмо с токеном для верификации.
- PIN-код и подтверждение успешной регистрации (в ожидании верификации) отправляются обратно в чат.

### 4. Верификация email

- Пользователь получает письмо с токеном и переходит по указанной ссылке.
- После успешной верификации:
    - Статус пользователя обновляется на **"активный"**.

### 5. Данные, остающиеся в чате

- После успешного завершения точки входа регистрации в чате остаются:
    - **PIN-код**, который является публичным идентификатором пользователя.
    - **Парольная фраза**, используемая для подтверждения прав на идентификатор.
- Пользователь должен запомнить эти данные для дальнейшего использования. В противном случае потребуется процедура
  восстановления доступа.

### 6. Доступ чата к веб-приложению

- После верификации email пользователь может полноценно использовать приложение через чат.
- Для доступа к функционалу через чат пользователь должен предоставить:
    - **PIN-код**.
    - **Парольную фразу** для подтверждения прав на идентификатор.
- Чат использует эти данные для взаимодействия с веб-приложением от имени пользователя.

---

## Точки входа

### `Fl64_Gpt_User_Back_Web_Api_SignUp_Init`

- **Описание:**
  Точка входа, доступная для ChatGPT, для инициации процесса регистрации.
  На этом этапе:
    - Создаётся запись пользователя.
    - Генерируется PIN-код.
    - Отправляется письмо с токеном верификации.

- **Параметры запроса:**
    - `consent` (логическое значение, обязательный): Согласие пользователя на обработку данных.
    - `email` (строка, обязательный): Адрес электронной почты пользователя.
    - `locale` (строка, обязательный): Локаль пользователя.
    - `passphrase` (строка, обязательный): Парольная фраза для подтверждения прав на PIN-код.

### `Fl64_Gpt_User_Back_Web_Api_SignUp_Verify`

- **Описание:**
  Точка входа, недоступная для ChatGPT, для подтверждения email-адреса.
  После подтверждения:
    - Статус пользователя обновляется на "активный".
    - PIN-код становится доступным для использования.

- **Параметры запроса:**
    - `token` (строка, обязательный): Токен верификации, отправленный на email пользователя.
