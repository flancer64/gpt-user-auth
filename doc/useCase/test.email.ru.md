# Сценарий отправки тестового email'а через ChatGPT

## Общие положения

Данный сценарий описывает процесс отправки зарегистрированным пользователем тестового email-сообщения через чат ChatGPT.
Основная цель - продемонстрировать возможность интеграции приложения с веб-сервисом
`Fl64_Gpt_User_Shared_Web_Api_Test_Email` для обработки таких запросов.

---

## Участники сценария

1. **Пользователь**:

- Зарегистрированный пользователь, обладающий уникальным PIN-кодом и кодовой фразой.
- Передаёт запрос на отправку email через чат.

2. **Модель LLM (ChatGPT)**:

- Выполняет обработку данных, поступающих от пользователя.
- Формирует запрос в структуре, соответствующей `Fl64_Gpt_User_Shared_Web_Api_Test_Email.Request`.
- Обрабатывает ответ от сервиса и возвращает результат пользователю.

3. **Веб-сервис**:

- Получает запрос на отправку email.
- Проверяет валидность данных пользователя.
- Отправляет сообщение и возвращает результат.

---

## Структура сценария

### 1. Входные данные пользователя

Пользователь должен предоставить:

- **PIN-код** (обязательное поле): уникальный идентификатор.
- **Кодовую фразу** (обязательное поле): строка для аутентификации.
- **Тему письма (subject)** (необязательное поле): строка, добавляющая контекст сообщению.
- **Тело письма (message)** (необязательное поле): текст сообщения.

Пример запроса от пользователя:

```
PIN: 1234
Passphrase: "мой уникальный код"
Subject: "Тестовый email"
Message: "Это тестовое сообщение."
```

### 2. Запрос, отправляемый ChatGPT

Модель формирует запрос в следующем формате:

```json
{
  "pin": 1234,
  "passPhrase": "мой уникальный код",
  "subject": "Тестовый email",
  "message": "Это тестовое сообщение."
}
```

### 3. Взаимодействие с веб-сервисом

Сервис обрабатывает запрос согласно следующей логике:

1. Аутентифицирует пользователя на основе `pin` и `passPhrase`.
2. Отправляет email на зарегистрированный адрес пользователя.
3. Возвращает результат операции.

### 4. Ответ веб-сервиса

Ответ сервиса структурирован в виде объекта:

```json
{
  "instructions": "The email was successfully sent to the user. Check the user's registered email for the message.",
  "resultCode": "SUCCESS"
}
```

Возможные значения `resultCode`:

- **SUCCESS**: Сообщение успешно отправлено.
- **SERVICE_ERROR**: Внутренняя ошибка сервиса.
- **UNAUTHENTICATED**: Неверные данные для аутентификации.

---

## Возможные ошибки и обработка

1. **Ошибка аутентификации (resultCode: UNAUTHENTICATED)**:

- Ответ пользователю: "Неверные PIN-код или кодовая фраза."

2. **Внутренняя ошибка (resultCode: SERVICE_ERROR)**:

- Ответ пользователю: "Не удалось отправить письмо из-за технической ошибки."

3. **Успех (resultCode: SUCCESS)**:

- Ответ пользователю: "Письмо успешно отправлено. Проверьте почту."

---
